<script src="http://cdn.steemjs.com/lib/latest/steem.min.js"></script>
<script>

async function getLatestAccountHistory(username) {
    var hist = await steem.api.getAccountHistory(username, -1, 0);
    return hist[0][0];
}

async function getAllAccountHistory(username) {
    var res = [];
    let max_id = await getLatestAccountHistory(username);

    let quotient = Math.floor(max_id / 1000);
    let remainder = max_id % 1000;
    console.log(quotient, remainder);

    res.push(... await steem.api.getAccountHistory(username, remainder, remainder));
    for (var i=1; i<=quotient; i++) {
        res.push(... await steem.api.getAccountHistory(username, remainder + i*1000, 999));
    }
    
    console.log('getAllAccountHistory() called: <- ' + username);
    return {
        max_id: max_id, 
        history: res
    };
}

var fs = require('fs');

// let username = 'jeongmincha';
// getAllAccountHistory(username).then(function(result){
//     // console.log(result.max_id);
//     // for (var i = 0; i < result.max_id + 1; i++) {        
//     // }
//     // console.log
//     // console.log(max_id);
//     // console.log(result[max_id]);
// });
// import 'fs';
// var fs = require('fs');
</script>
